<!DOCTYPE HTML>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-56CH9Q34BG"></script>
		<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-56CH9Q34BG');
		</script>
		
		<title>Excel vs. Python</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="inner">

							<!-- Logo -->
								<a href="index.html" class="logo">
									<span class="symbol"><img src="images/logo.svg" alt="" /></span><span class="title">Home</span>
								</a>
							
							<!-- Nav -->
							<nav>
								<ul>
									<li><a href="#menu">Menu</a></li>
								</ul>
							</nav>

						</div>
					</header>

				<!-- Menu -->
				<nav id="menu">
					<h2>Menu</h2>
					<ul id="menu-list">
						<!-- Menu items will be generated dynamically here -->
					</ul>
				</nav>

				<!-- Main -->
					<div id="main">
						<div class="inner">
							<h1>Excel vs Python: Data Handling Experiment</h1>
								<p>In the final phase of my career as a financial planner and corporate finance practitioner, I heavily relied on Excel. It served as my go-to for not only data manipulation but also financial modeling, dashboard creation, note-taking, and project planning. However, transitioning into data science introduced me to Python's superior speed and efficiency in managing data—a potential I had always heard about but never integrated into my toolkit.</p>
								<p>In this analysis, I aim to conduct a head-to-head comparison between Excel’s Power Query, a robust tool for data manipulation, and Python’s Pandas library. This comparison will focus on a task that was commonly encountered in my workflow: loading datasets, merging and transforming them and saving the results.</p>
								<p>My goal is to provide valuable insights for those considering the integration of Python into their data handling processes.</p>
								<p>You can find the files for this analysis here: <a href="https://github.com/morilucas/excelvspython">Github Repository</a>.</p>
								<p><strong>Tools Used:</strong> Python, Pandas, Excel, Power Query, Seaborn</p>
						
							<h2>Approach:</h2>
						
								<p><span class="image right"><img src="images/excelvspython/experiment.png" alt="" /></span>The general plan involve two broad steps: 1. Generate Datasets -a Python script will generate two datasets, each with a flexible number of rows, allowing us to analyze how both methods perform as the number of rows increases; 2. Merge and save - an excel spreadsheet and a python script that will perform the same task of loading the data, merging the two datasets, and saving the results.</p>
								<ol>
									<li>Generate Datasets</li>
									<ol>
										<li>Create a dataset with 60 columns and a variable number of rows.</li>
										<li>Split the dataset into two dataframes: 
											<ul>
												<li>Dataframe 1 consists of the first 30 columns.</li>
												<li>Dataframe 2 consists of the remaining 30 columns.</li>
											</ul>
											Both dataframes should include a column with a unique identifier (a number that uniquely identifies each row).
										</li>
										<li>Shuffle the rows in Dataframe 2.</li>
										<li>Save both dataframes. Then repeat the process with a different number of rows.</li>
									</ol>
									<li>Merge and save (timed task for both methods)</li>
									<ol>
										<ol>
											<li>Open File (only relevant for Excel)</li>
											<li>Load Dataframes 1 and 2</li>
											<li>Merge</li>
											<li>Save as a .csv/.xlsx file</li>
										</ol>
									</ol>

							<h2>Analysis:</h2>
							
							<h4>Overall Comparison</h4>
								<p>Our first step is to compare the performance of both methods as the number of rows increases and to assess how much slower Excel is compared to Python.</p>
								<div style="display: flex; justify-content: center; align-items: center; margin: 2em 0 2em 0;">
									<figure style="flex: 1; margin-right: 10px; text-align: center;">
										<img src="images/excelvspython/avg_lineplot.png" alt="Excel vs. Python Line Plot Comparison" style="width: 100%; height: auto;"/>
										<figcaption>Figure 1: Line Plot Comparison between Excel and Python. Blue line represents Excel data, and red line represents Python data.</figcaption>
									</figure>
									<figure style="flex: 1; margin-left: 10px; text-align: center;">
										<img src="images/excelvspython/howmanytimesslower_excel.png" alt="How many times slower?" style="width: 100%; height: auto;"/>
										<figcaption>Figure 2: Performance Ratio of Excel to Python by Row Count. This graph illustrates how Excel's processing time compares to Python's across different data sizes.</figcaption>
									</figure>
								</div>
								<ul>
									<li>Analyzing Figure 1, we can observe that both Excel and Python exhibit a linear behavior as the number of rows increases. However, Excel's curve is noticeably steeper, indicating tha Excel's processing time increases "faster" compared to Python as the dataset size grows.</li>
									<li>Moving on to Figure 2, excluding the results for tasks with 1,000 rows, we can conclude that Excel's performance is on average ten times slower than Python's in executing the given task.</li>
								</ul>
							
							<h4>Breakdown</h4>
								<p>We go one level deeper and analyze how much of the total time is spent on each step percentage-wise.</p>
								<div style="display: flex; justify-content: center; align-items: center; margin: 2em 0 2em 0;">
									<figure style="flex: 1; margin-right: 10px; text-align: center;">
										<img src="images/excelvspython/breakdown_excel.png" alt="Excel vs. Python Line Plot Comparison" style="width: 100%; height: auto;"/>
										<figcaption>Figure 3: Proportional Time Spent on Each Operation in Excel by Row Volume.</figcaption>
									</figure>
									<figure style="flex: 1; margin-left: 10px; text-align: center;">
										<img src="images/excelvspython/breakdown_python.png" alt="How many times slower?" style="width: 100%; height: auto;"/>
										<figcaption>Figure 4: Proportional Time Spent on Each Operation in Python by Row Volume.</figcaption>
									</figure>
								</div>
							
								<ul>
									<li>Figure 3 indicates that the time taken to open and save an Excel file may account for more than 40% of the total task duration, depending on the number of rows in the dataframes.</li>
									<li>And that for Python (Figure 4), on average, saving the results as a .csv file consumes more than 80% of the total processing time.</li>							
								</ul>

							<h2>Takeaways:</h2>
							<ul>
								<li>Excel's Power Query is on average 10 times slower than Python for the same task.</li>
								<li>In Python, saving data to a .csv file can take up to 80% of the total time. So being mindful of when and how often you save data can greatly affect the performance of a data manipulation task.</li>
								<li>Contrary to my initial intuition, loading and merging data takes less time than opening files and saving results for both methods.</li>
							</ul>
							<figure style="flex: 1; margin-right: 10px; text-align: center;">
								<img src="images/excelvspython/takeaways.png" alt="Key Takeaways" style="width: 50%; height: auto;"/>
							</figure>

						</div>
					</div>

				<!-- Footer -->
				<footer id="footer">
					<div class="inner">
						<section>
							<h2>Follow</h2>
							<ul class="icons">
								<li><a href="https://www.linkedin.com/in/morilucas/" class="icon brands style2 fa-linkedin"><span class="label">Linkedin</span></a></li>
								<li><a href="https://github.com/morilucas" class="icon brands style2 fa-github"><span class="label">GitHub</span></a></li>
							</ul>
						</section>
					</div>
				</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>